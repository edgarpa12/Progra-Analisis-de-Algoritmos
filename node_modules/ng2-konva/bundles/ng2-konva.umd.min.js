!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("ng2-konva",["exports","@angular/core","@angular/common"],e):e(t["ng2-konva"]={},t.ng.core,t.ng.common)}(this,function(t,r,e){"use strict";var n=function(){return(n=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function o(t){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}function i(t,r,i){if(void 0===r&&(r={}),void 0===i&&(i={}),"id"in r){console.warn('ng2-konva: You are using "id" attribute for Konva node. In some very rare cases it may produce bugs. Currently we recommend not to use it and use "name" attribute instead.')}var n,a=t._stage,s={},u=!1;(Object.keys(i).forEach(function(t){var e="on"===t.slice(0,2),n=i[t]!==r[t];if(e&&n){var o=t.substr(2).toLowerCase();"content"===o.substr(0,7)&&(o="content"+o.substr(7,1).toUpperCase()+o.substr(8)),a.off(o,i[t])}!r.hasOwnProperty(t)&&a.setAttr(t,undefined)}),Object.keys(r).forEach(function(e){var t="on"===e.slice(0,2),n=i[e]!==r[e];if(t&&n){var o=e.substr(2).toLowerCase();"content"===o.substr(0,7)&&(o="content"+o.substr(7,1).toUpperCase()+o.substr(8)),r[e]&&(a.off(o),a.on(o,function(t){r[e](t.target.AngularComponent,t)}))}t||r[e]===i[e]&&r[e]===a.getAttr(e)||(u=!0,s[e]=r[e])}),u)&&(a.setAttrs(s),o(a),Object.keys(s).forEach(function(t){if((n=s[t])instanceof Image&&!n.complete){var e=a;n.addEventListener("load",function(){var t=e.getLayer();t&&t.batchDraw()})}}))}function a(e){var n={};return["click","dblclick","mouseover","mouseout","mousemove","tap","dbltap","touchstart","scaleXChange","fillChange","dragstart","dragmove","dragend"].forEach(function(t){e[t].observers.length&&(n["on"+t]=e[t].emit.bind(e[t]))}),n}var s=function(){function t(t){var e,n,o;this.elementRef=t,this.shapes=new r.QueryList,this.click=new r.EventEmitter,this.dblclick=new r.EventEmitter,this.mouseover=new r.EventEmitter,this.mouseout=new r.EventEmitter,this.mousemove=new r.EventEmitter,this.tap=new r.EventEmitter,this.dbltap=new r.EventEmitter,this.touchstart=new r.EventEmitter,this.scaleXChange=new r.EventEmitter,this.fillChange=new r.EventEmitter,this.dragstart=new r.EventEmitter,this.dragmove=new r.EventEmitter,this.dragend=new r.EventEmitter,this.added=!1,this.cacheProps={},this._stage={},this.nameNode=(e=t.nativeElement.localName,o=e.substr(3).replace("-"," "),(n=o.replace(/(?:^\w|[A-Z]|\b\w)/g,function(t,e){return 0==e?t.toLowerCase():t.toUpperCase()}).replace(/\s+/g,"")).charAt(0).toUpperCase()+n.slice(1))}return t.prototype.getStage=function(){return this._stage},t.prototype.getConfig=function(){return this._config||{}},t.prototype.ngOnInit=function(){this.initKonva()},t.prototype.initKonva=function(){var e=this,n=this,t=Konva[this.nameNode];this._stage=new t;var o=(this._stage.AngularComponent=this)._stage.to.bind(this._stage);this._stage.to=function(t){o(t),setTimeout(function(){Object.keys(n._stage.attrs).forEach(function(t){"function"!=typeof n._stage.attrs[t]&&(n.config[t]=n._stage.attrs[t])})},200)},this.config&&this.config.subscribe(function(t){e._config=t,e.uploadKonva(t)})},t.prototype.uploadKonva=function(t){var e=n({},t,a(this));i(this,e,this.cacheProps),this.cacheProps=e},t.prototype.ngAfterContentInit=function(){var e=this;this.shapes.forEach(function(t){e!==t&&(t.added=!0,e._stage.add(t.getStage()),o(e._stage))})},t.prototype.ngOnDestroy=function(){this._stage.destroy()},t.decorators=[{type:r.Component,args:[{selector:"ko-shape, ko-layer, ko-circle, ko-fastlayer, ko-group, ko-label, ko-rect, ko-ellipse, ko-wedge, ko-line, ko-sprite, ko-image, ko-text, ko-text-path, ko-star, ko-ring, ko-arc, ko-tag, ko-path, ko-regular-polygon, ko-arrow",template:"<div><ng-content></ng-content></div>"}]}],t.ctorParameters=function(){return[{type:r.ElementRef}]},t.propDecorators={shapes:[{type:r.ContentChildren,args:[t]}],config:[{type:r.Input}],click:[{type:r.Output}],dblclick:[{type:r.Output}],mouseover:[{type:r.Output}],mouseout:[{type:r.Output}],mousemove:[{type:r.Output}],tap:[{type:r.Output}],dbltap:[{type:r.Output}],touchstart:[{type:r.Output}],scaleXChange:[{type:r.Output}],fillChange:[{type:r.Output}],dragstart:[{type:r.Output}],dragmove:[{type:r.Output}],dragend:[{type:r.Output}]},t}(),u=function(){function t(t){this.elementRef=t,this.shapes=new r.QueryList,this.click=new r.EventEmitter,this.dblclick=new r.EventEmitter,this.mouseover=new r.EventEmitter,this.mouseout=new r.EventEmitter,this.mousemove=new r.EventEmitter,this.tap=new r.EventEmitter,this.dbltap=new r.EventEmitter,this.touchstart=new r.EventEmitter,this.scaleXChange=new r.EventEmitter,this.fillChange=new r.EventEmitter,this.dragstart=new r.EventEmitter,this.dragmove=new r.EventEmitter,this.dragend=new r.EventEmitter,this.cacheProps={}}return t.prototype.getStage=function(){return this._stage||{}},t.prototype.getConfig=function(){return this._config||{}},t.prototype.uploadKonva=function(t){var e=n({},t,a(this));i(this,e,this.cacheProps),this.cacheProps=e},t.prototype.ngOnInit=function(){var e=this,n=this.elementRef.nativeElement;this.config.subscribe(function(t){e._config=t,e._stage||(e._stage=new Konva.Stage({width:t.width,height:t.height,container:n})),e.uploadKonva(t)})},t.prototype.ngAfterContentInit=function(){var e=this;this.shapes.forEach(function(t){e._stage.add(t.getStage()),o(e._stage)})},t.prototype.ngOnDestroy=function(){this._stage.destroy()},t.decorators=[{type:r.Component,args:[{selector:"ko-stage",template:"<div><ng-content></ng-content>{{config}}</div>"}]}],t.ctorParameters=function(){return[{type:r.ElementRef}]},t.propDecorators={shapes:[{type:r.ContentChildren,args:[s]}],config:[{type:r.Input}],click:[{type:r.Output}],dblclick:[{type:r.Output}],mouseover:[{type:r.Output}],mouseout:[{type:r.Output}],mousemove:[{type:r.Output}],tap:[{type:r.Output}],dbltap:[{type:r.Output}],touchstart:[{type:r.Output}],scaleXChange:[{type:r.Output}],fillChange:[{type:r.Output}],dragstart:[{type:r.Output}],dragmove:[{type:r.Output}],dragend:[{type:r.Output}]},t}();"undefined"==typeof window||window.Konva||require("konva");var p=function(){function t(){}return t.decorators=[{type:r.NgModule,args:[{imports:[e.CommonModule],declarations:[u,s],exports:[u,s]}]}],t}();t.KonvaModule=p,t.StageComponent=u,t.CoreShapeComponent=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ng2-konva.umd.min.js.map